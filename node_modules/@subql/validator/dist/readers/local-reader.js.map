{"version":3,"file":"local-reader.js","sourceRoot":"","sources":["../../src/readers/local-reader.ts"],"names":[],"mappings":";AAAA,gEAAgE;AAChE,sCAAsC;;;;;;;;;;;;;;;;;;;;;;AAEtC,uCAAyB;AACzB,2CAA6B;AAC7B,0CAAiD;AAIjD,MAAa,WAAW;IACtB,YAA6B,WAAmB;QAAnB,gBAAW,GAAX,WAAW,CAAQ;IAAG,CAAC;IAEpD,KAAK,CAAC,MAAM;QACV,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;IACtC,CAAC;IAED,KAAK,CAAC,gBAAgB;QACpB,OAAO,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;IACtC,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,QAAgB;QAC5B,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;QACnD,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;YACxB,OAAO,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;SACnC;QACD,IAAI;YACF,OAAO,IAAA,2BAAkB,EAAC,IAAI,CAAC,CAAC;SACjC;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,SAAS,CAAC;SAClB;IACH,CAAC;CACF;AAtBD,kCAsBC","sourcesContent":["// Copyright 2020-2021 OnFinality Limited authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\nimport * as fs from 'fs';\nimport * as path from 'path';\nimport {loadFromJsonOrYaml} from '@subql/common';\nimport {IPackageJson} from 'package-json-type';\nimport {Reader} from './reader';\n\nexport class LocalReader implements Reader {\n  constructor(private readonly projectPath: string) {}\n\n  async getPkg(): Promise<IPackageJson | undefined> {\n    return this.getFile('package.json');\n  }\n\n  async getProjectSchema(): Promise<unknown | undefined> {\n    return this.getFile('project.yaml');\n  }\n\n  async getFile(fileName: string): Promise<unknown | undefined> {\n    const file = path.join(this.projectPath, fileName);\n    if (!fs.existsSync(file)) {\n      return Promise.resolve(undefined);\n    }\n    try {\n      return loadFromJsonOrYaml(file);\n    } catch (e) {\n      return undefined;\n    }\n  }\n}\n"]}