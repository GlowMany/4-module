(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.InterfaceDatastore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var InterfaceDatastore=(()=>{var Ce=Object.defineProperty;var Xt=r=>Ce(r,"__esModule",{value:!0});var Mn=typeof require!="undefined"?require:r=>{throw new Error('Dynamic require of "'+r+'" is not supported')};var i=(r,e)=>()=>(r&&(e=r(r=0)),e);var w=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),l=(r,e)=>{Xt(r);for(var t in e)Ce(r,t,{get:e[t],enumerable:!0})};var De,Ue=i(()=>{De="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"});var ne={};l(ne,{customAlphabet:()=>Gt,customRandom:()=>Ne,nanoid:()=>Qt,random:()=>Ie,urlAlphabet:()=>De});var Ie,Ne,Gt,Qt,se=i(()=>{Ue();Ie=r=>crypto.getRandomValues(new Uint8Array(r)),Ne=(r,e,t)=>{let n=(2<<Math.log(r.length-1)/Math.LN2)-1,s=-~(1.6*n*e/r.length);return()=>{let o="";for(;;){let a=t(s),d=s;for(;d--;)if(o+=r[a[d]&n]||"",o.length===e)return o}}},Gt=(r,e)=>Ne(r,e,Ie),Qt=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r));for(;r--;){let n=t[r]&63;n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n<63?e+="_":e+="-"}return e}});function Ht(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var s=0;s<r.length;s++){var o=r.charAt(s),a=o.charCodeAt(0);if(t[a]!==255)throw new TypeError(o+" is ambiguous");t[a]=s}var d=r.length,p=r.charAt(0),T=Math.log(d)/Math.log(256),m=Math.log(256)/Math.log(d);function k(c){if(c instanceof Uint8Array||(ArrayBuffer.isView(c)?c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength):Array.isArray(c)&&(c=Uint8Array.from(c))),!(c instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(c.length===0)return"";for(var u=0,M=0,g=0,v=c.length;g!==v&&c[g]===0;)g++,u++;for(var E=(v-g)*m+1>>>0,y=new Uint8Array(E);g!==v;){for(var S=c[g],I=0,x=E-1;(S!==0||I<M)&&x!==-1;x--,I++)S+=256*y[x]>>>0,y[x]=S%d>>>0,S=S/d>>>0;if(S!==0)throw new Error("Non-zero carry");M=I,g++}for(var C=E-M;C!==E&&y[C]===0;)C++;for(var J=p.repeat(u);C<E;++C)J+=r.charAt(y[C]);return J}function W(c){if(typeof c!="string")throw new TypeError("Expected String");if(c.length===0)return new Uint8Array;var u=0;if(c[u]!==" "){for(var M=0,g=0;c[u]===p;)M++,u++;for(var v=(c.length-u)*T+1>>>0,E=new Uint8Array(v);c[u];){var y=t[c.charCodeAt(u)];if(y===255)return;for(var S=0,I=v-1;(y!==0||S<g)&&I!==-1;I--,S++)y+=d*E[I]>>>0,E[I]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");g=S,u++}if(c[u]!==" "){for(var x=v-g;x!==v&&E[x]===0;)x++;for(var C=new Uint8Array(M+(v-x)),J=M;x!==v;)C[J++]=E[x++];return C}}}function Jt(c){var u=W(c);if(u)return u;throw new Error(`Non-${e} character`)}return{encode:k,decodeUnsafe:W,decode:Jt}}var Kt,Yt,Oe,Me=i(()=>{Kt=Ht,Yt=Kt,Oe=Yt});var zn,Te,D,ke,Le,N=i(()=>{zn=new Uint8Array(0),Te=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},D=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},ke=r=>new TextEncoder().encode(r),Le=r=>new TextDecoder().decode(r)});var ze,_e,X,Be,G,O,Zt,er,f,A=i(()=>{Me();N();ze=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},_e=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){let t={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new X(t)}},X=class{constructor(e){this.decoders=e}or(e){let t=e.decoders||{[e.prefix]:e};return new X({...this.decoders,...t})}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Be=class{constructor(e,t,n,s){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=s,this.encoder=new ze(e,t,n),this.decoder=new _e(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},G=({name:r,prefix:e,encode:t,decode:n})=>new Be(r,e,t,n),O=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:s}=Oe(t,e);return G({prefix:r,name:e,encode:n,decode:o=>D(s(o))})},Zt=(r,e,t,n)=>{let s={};for(let m=0;m<e.length;++m)s[e[m]]=m;let o=r.length;for(;r[o-1]==="=";)--o;let a=new Uint8Array(o*t/8|0),d=0,p=0,T=0;for(let m=0;m<o;++m){let k=s[r[m]];if(k===void 0)throw new SyntaxError(`Non-${n} character`);p=p<<t|k,d+=t,d>=8&&(d-=8,a[T++]=255&p>>d)}if(d>=t||255&p<<8-d)throw new SyntaxError("Unexpected end of data");return a},er=(r,e,t)=>{let n=e[e.length-1]==="=",s=(1<<t)-1,o="",a=0,d=0;for(let p=0;p<r.length;++p)for(d=d<<8|r[p],a+=8;a>t;)a-=t,o+=e[s&d>>a];if(a&&(o+=e[s&d<<t-a]),n)for(;o.length*t&7;)o+="=";return o},f=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>G({prefix:e,name:r,encode(s){return er(s,n,t)},decode(s){return Zt(s,n,t,r)}})});var oe={};l(oe,{identity:()=>tr});var tr,Pe=i(()=>{A();N();tr=G({prefix:"\0",name:"identity",encode:r=>Le(r),decode:r=>ke(r)})});var ie={};l(ie,{base2:()=>rr});var rr,Fe=i(()=>{A();rr=f({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var ae={};l(ae,{base8:()=>nr});var nr,Ve=i(()=>{A();nr=f({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var ce={};l(ce,{base10:()=>sr});var sr,qe=i(()=>{A();sr=O({prefix:"9",name:"base10",alphabet:"0123456789"})});var de={};l(de,{base16:()=>or,base16upper:()=>ir});var or,ir,$e=i(()=>{A();or=f({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ir=f({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var fe={};l(fe,{base32:()=>L,base32hex:()=>fr,base32hexpad:()=>pr,base32hexpadupper:()=>ur,base32hexupper:()=>hr,base32pad:()=>cr,base32padupper:()=>dr,base32upper:()=>ar,base32z:()=>lr});var L,ar,cr,dr,fr,hr,pr,ur,lr,he=i(()=>{A();L=f({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ar=f({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),cr=f({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),dr=f({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fr=f({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hr=f({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),pr=f({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ur=f({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),lr=f({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var pe={};l(pe,{base36:()=>br,base36upper:()=>mr});var br,mr,We=i(()=>{A();br=O({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),mr=O({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var ue={};l(ue,{base58btc:()=>j,base58flickr:()=>yr});var j,yr,le=i(()=>{A();j=O({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yr=O({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var be={};l(be,{base64:()=>wr,base64pad:()=>gr,base64url:()=>xr,base64urlpad:()=>vr});var wr,gr,xr,vr,Je=i(()=>{A();wr=f({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gr=f({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xr=f({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vr=f({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});function Ge(r,e,t){e=e||[],t=t||0;for(var n=t;r>=jr;)e[t++]=r&255|Xe,r/=128;for(;r&Ar;)e[t++]=r&255|Xe,r>>>=7;return e[t]=r|0,Ge.bytes=t-n+1,e}function me(r,e){var t=0,e=e||0,n=0,s=e,o,a=r.length;do{if(s>=a)throw me.bytes=0,new RangeError("Could not decode varint");o=r[s++],t+=n<28?(o&Qe)<<n:(o&Qe)*Math.pow(2,n),n+=7}while(o>=Dr);return me.bytes=s-e,t}var Er,Xe,Sr,Ar,jr,Cr,Dr,Qe,Ur,Ir,Nr,Or,Mr,Tr,kr,Lr,Rr,zr,_r,Br,B,He=i(()=>{Er=Ge,Xe=128,Sr=127,Ar=~Sr,jr=Math.pow(2,31);Cr=me,Dr=128,Qe=127;Ur=Math.pow(2,7),Ir=Math.pow(2,14),Nr=Math.pow(2,21),Or=Math.pow(2,28),Mr=Math.pow(2,35),Tr=Math.pow(2,42),kr=Math.pow(2,49),Lr=Math.pow(2,56),Rr=Math.pow(2,63),zr=function(r){return r<Ur?1:r<Ir?2:r<Nr?3:r<Or?4:r<Mr?5:r<Tr?6:r<kr?7:r<Lr?8:r<Rr?9:10},_r={encode:Er,decode:Cr,encodingLength:zr},Br=_r,B=Br});var P,R,z,Q=i(()=>{He();P=r=>[B.decode(r),B.decode.bytes],R=(r,e,t=0)=>(B.encode(r,e,t),e),z=r=>B.encodingLength(r)});var H,Ye,Ze,F,K=i(()=>{N();Q();H=(r,e)=>{let t=e.byteLength,n=z(r),s=n+z(t),o=new Uint8Array(s+t);return R(r,o,0),R(t,o,n),o.set(e,s),new F(r,t,e,o)},Ye=r=>{let e=D(r),[t,n]=P(e),[s,o]=P(e.subarray(n)),a=e.subarray(n+o);if(a.byteLength!==s)throw new Error("Incorrect length");return new F(t,s,a,e)},Ze=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&Te(r.bytes,e.bytes),F=class{constructor(e,t,n,s){this.code=e,this.size=t,this.digest=n,this.bytes=s}}});var V,tt,Y=i(()=>{K();V=({name:r,code:e,encode:t})=>new tt(r,e,t),tt=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}async digest(e){if(e instanceof Uint8Array){let t=await this.encode(e);return H(this.code,t)}else throw Error("Unknown type, must be binary type")}}});var ye={};l(ye,{sha256:()=>Pr,sha512:()=>Fr});var nt,Pr,Fr,st=i(()=>{Y();nt=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Pr=V({name:"sha2-256",code:18,encode:nt("SHA-256")}),Fr=V({name:"sha2-512",code:19,encode:nt("SHA-512")})});var we={};l(we,{identity:()=>Vr});var Vr,ot=i(()=>{Y();N();Vr=V({name:"identity",code:0,encode:r=>D(r)})});var it=i(()=>{N()});var is,as,at=i(()=>{is=new TextEncoder,as=new TextDecoder});var h,Wr,Jr,Xr,q,Gr,ct,dt,Z,ee,Qr,Hr,Kr,ft=i(()=>{Q();K();le();he();N();h=class{constructor(e,t,n,s){this.code=t,this.version=e,this.multihash=n,this.bytes=s,this.byteOffset=s.byteOffset,this.byteLength=s.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:ee,byteLength:ee,code:Z,version:Z,multihash:Z,bytes:Z,_baseCache:ee,asCID:ee})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==q)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Gr)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return h.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=H(e,t);return h.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ze(this.multihash,e.multihash)}toString(e){let{bytes:t,version:n,_baseCache:s}=this;switch(n){case 0:return Jr(t,s,e||j.encoder);default:return Xr(t,s,e||L.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Hr(/^0\.0/,Kr),!!(e&&(e[dt]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof h)return e;if(e!=null&&e.asCID===e){let{version:t,code:n,multihash:s,bytes:o}=e;return new h(t,n,s,o||ct(t,n,s.bytes))}else if(e!=null&&e[dt]===!0){let{version:t,multihash:n,code:s}=e,o=Ye(n);return h.create(t,s,o)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==q)throw new Error(`Version 0 CID must use dag-pb (code: ${q}) block encoding`);return new h(e,t,n,n.bytes)}case 1:{let s=ct(e,t,n.bytes);return new h(e,t,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return h.create(0,q,e)}static createV1(e,t){return h.create(1,e,t)}static decode(e){let[t,n]=h.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=h.inspectBytes(e),n=t.size-t.multihashSize,s=D(e.subarray(n,n+t.multihashSize));if(s.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=s.subarray(t.multihashSize-t.digestSize),a=new F(t.multihashCode,t.digestSize,o,s);return[t.version===0?h.createV0(a):h.createV1(t.codec,a),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[k,W]=P(e.subarray(t));return t+=W,k},s=n(),o=q;if(s===18?(s=0,t=0):s===1&&(o=n()),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let a=t,d=n(),p=n(),T=t+p,m=T-a;return{version:s,codec:o,multihashCode:d,digestSize:p,multihashSize:m,size:T}}static parse(e,t){let[n,s]=Wr(e,t),o=h.decode(s);return o._baseCache.set(n,e),o}},Wr=(r,e)=>{switch(r[0]){case"Q":{let t=e||j;return[j.prefix,t.decode(`${j.prefix}${r}`)]}case j.prefix:{let t=e||j;return[j.prefix,t.decode(r)]}case L.prefix:{let t=e||L;return[L.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},Jr=(r,e,t)=>{let{prefix:n}=t;if(n!==j.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let s=e.get(n);if(s==null){let o=t.encode(r).slice(1);return e.set(n,o),o}else return s},Xr=(r,e,t)=>{let{prefix:n}=t,s=e.get(n);if(s==null){let o=t.encode(r);return e.set(n,o),o}else return s},q=112,Gr=18,ct=(r,e,t)=>{let n=z(r),s=n+z(e),o=new Uint8Array(s+t.byteLength);return R(r,o,0),R(e,o,n),o.set(t,s),o},dt=Symbol.for("@ipld/js-cid/CID"),Z={writable:!1,configurable:!1,enumerable:!0},ee={writable:!1,enumerable:!1,configurable:!1},Qr="0.0.0-dev",Hr=(r,e)=>{if(r.test(Qr))console.warn(e);else throw new Error(e)},Kr=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var ht=i(()=>{ft();Q();N();Y();K()});var ge,ys,pt=i(()=>{Pe();Fe();Ve();qe();$e();he();We();le();Je();st();ot();it();at();ht();ge={...oe,...ie,...ae,...ce,...de,...fe,...pe,...ue,...be},ys={...ye,...we}});function ut(r,e,t,n){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:n}}}var lt,xe,Yr,te,ve=i(()=>{pt();lt=ut("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),xe=ut("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Yr={utf8:lt,"utf-8":lt,hex:ge.base16,latin1:xe,ascii:xe,binary:xe,...ge},te=Yr});var bt={};l(bt,{toString:()=>Zr});function Zr(r,e="utf8"){let t=te[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}var mt=i(()=>{ve()});var yt={};l(yt,{fromString:()=>en});function en(r,e="utf8"){let t=te[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}var wt=i(()=>{ve()});var Ee=w((Ss,xt)=>{"use strict";var{nanoid:tn}=(se(),ne),{toString:rn}=(mt(),bt),{fromString:nn}=(wt(),yt),U="/",gt=new TextEncoder().encode(U),re=gt[0],b=class{constructor(e,t){if(typeof e=="string")this._buf=nn(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==re)throw new Error("Invalid key")}toString(e="utf8"){return rn(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new b(e.join(U))}static random(){return new b(tn().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new b(e):e.uint8Array?new b(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=gt),this._buf[0]!==re){let e=new Uint8Array(this._buf.byteLength+1);e.fill(re,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===re;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),n=e.list();for(let s=0;s<t.length;s++){if(n.length<s+1)return!1;let o=t[s],a=n[s];if(o<a)return!0;if(o>a)return!1}return t.length<n.length}reverse(){return b.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(U).slice(1)}type(){return sn(this.baseNamespace())}name(){return on(this.baseNamespace())}instance(e){return new b(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(U)||(e+=U),e+=this.type(),new b(e)}parent(){let e=this.list();return e.length===1?new b(U):new b(e.slice(0,-1).join(U))}child(e){return this.toString()===U?e:e.toString()===U?this:new b(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return b.withNamespaces([...this.namespaces(),...an(e.map(t=>t.namespaces()))])}};function sn(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function on(r){let e=r.split(":");return e[e.length-1]}function an(r){return[].concat(...r)}xt.exports=b});var Et=w((As,vt)=>{"use strict";var{nanoid:cn}=(se(),ne),dn=(r=e=>e)=>r(cn());vt.exports=dn});var At=w((js,St)=>{"use strict";var fn=async r=>{let e=[];for await(let t of r)e.push(t);return e};St.exports=fn});var Se=w((Cs,jt)=>{"use strict";var hn=Et(),pn=At(),un=(r,e)=>async function*(){yield*(await pn(r)).sort(e)}(),ln=(r,e)=>{let t=new RegExp("^"+e);return r.replace(t,"")};jt.exports={sortAll:un,tmpdir:hn,replaceStartWith:ln}});var Dt=w((Ds,Ct)=>{"use strict";var bn=async r=>{for await(let e of r);};Ct.exports=bn});var It=w((Us,Ut)=>{"use strict";var mn=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};Ut.exports=mn});var Ot=w((Is,Nt)=>{"use strict";var yn=async function*(r,e){let t=0;if(!(e<1)){for await(let n of r)if(yield n,t++,t===e)return}};Nt.exports=yn});var Ae=w((Ns,Rt)=>{"use strict";var{sortAll:Mt}=Se(),Tt=Dt(),_=It(),kt=Ot(),Lt=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,n){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:n,value:s}of e)await this.put(n,s,t),yield{key:n,value:s}}async*getMany(e,t={}){for await(let n of e)yield this.get(n,t)}async*deleteMany(e,t={}){for await(let n of e)await this.delete(n,t),yield n}batch(){let e=[],t=[];return{put(n,s){e.push({key:n,value:s})},delete(n){t.push(n)},commit:async n=>{await Tt(this.putMany(e,n)),e=[],await Tt(this.deleteMany(t,n)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let n=this._all(e,t);if(e.prefix!=null&&(n=_(n,s=>s.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((s,o)=>_(s,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((s,o)=>Mt(s,o),n)),e.offset!=null){let s=0;n=_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=kt(n,e.limit)),n}queryKeys(e,t){let n=this._allKeys(e,t);if(e.prefix!=null&&(n=_(n,s=>s.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((s,o)=>_(s,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((s,o)=>Mt(s,o),n)),e.offset!=null){let s=0;n=_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=kt(n,e.limit)),n}};Rt.exports=Lt});var Bt=w((Os,_t)=>{"use strict";function zt(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function wn(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return zt(r,t)}catch(n){t.message=r.message,t.stack=r.stack;let s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(r)),zt(new s,t)}}_t.exports=wn});var je=w((Ms,Pt)=>{"use strict";var $=Bt();function gn(r){return r=r||new Error("Cannot open database"),$(r,"ERR_DB_OPEN_FAILED")}function xn(r){return r=r||new Error("Delete failed"),$(r,"ERR_DB_DELETE_FAILED")}function vn(r){return r=r||new Error("Write failed"),$(r,"ERR_DB_WRITE_FAILED")}function En(r){return r=r||new Error("Not Found"),$(r,"ERR_NOT_FOUND")}function Sn(r){return r=r||new Error("Aborted"),$(r,"ERR_ABORTED")}Pt.exports={dbOpenFailedError:gn,dbDeleteFailedError:xn,dbWriteFailedError:vn,notFoundError:En,abortedError:Sn}});var $t=w((Ts,qt)=>{"use strict";var Ft=Ee(),An=Ae(),jn=je(),Vt=class extends An{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw jn.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new Ft(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new Ft(e))}};qt.exports=Vt});var On=w((ks,Wt)=>{"use strict";var Cn=Ee(),Dn=$t(),Un=Se(),In=je(),Nn=Ae();Wt.exports={Key:Cn,MemoryDatastore:Dn,utils:Un,Errors:In,Adapter:Nn}});return On();})();
return InterfaceDatastore}));
